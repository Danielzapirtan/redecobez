<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Redecorează apartamentul - Minimalist cu Plante + 3D</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f8f9fa;
            color: #333;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #e0e0e0;
        }
        
        h1 {
            color: #2c3e50;
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .tagline {
            color: #27ae60;
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 10px;
        }
        
        .subtitle {
            color: #7f8c8d;
            font-size: 1.1rem;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .app-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
        }
        
        .upload-section {
            flex: 1;
            min-width: 300px;
            background: white;
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }
        
        .design-section {
            flex: 2;
            min-width: 500px;
            background: white;
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            display: flex;
            flex-direction: column;
        }
        
        .section-title {
            font-size: 1.4rem;
            color: #2c3e50;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
            display: flex;
            align-items: center;
        }
        
        .section-title i {
            margin-right: 10px;
        }
        
        .upload-area {
            border: 2px dashed #27ae60;
            border-radius: 8px;
            padding: 40px 20px;
            text-align: center;
            margin-bottom: 20px;
            cursor: pointer;
            transition: all 0.3s;
            background-color: #f8fafc;
        }
        
        .upload-area:hover {
            background-color: #e8f8f0;
            border-color: #219653;
        }
        
        .upload-icon {
            font-size: 3rem;
            color: #27ae60;
            margin-bottom: 15px;
        }
        
        .upload-text {
            font-size: 1.1rem;
            color: #555;
        }
        
        .upload-text small {
            display: block;
            margin-top: 10px;
            color: #888;
        }
        
        #roomImage {
            display: none;
        }
        
        .room-preview {
            margin-top: 20px;
            display: none;
        }
        
        .room-preview img {
            max-width: 100%;
            border-radius: 8px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
        }
        
        .style-selection {
            margin-top: 25px;
        }
        
        .style-options {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .style-option {
            border: 2px solid #eee;
            border-radius: 8px;
            padding: 15px 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .style-option:hover {
            border-color: #27ae60;
            transform: translateY(-3px);
        }
        
        .style-option.active {
            border-color: #27ae60;
            background-color: #e8f8f0;
        }
        
        .style-icon {
            font-size: 2rem;
            margin-bottom: 10px;
            color: #555;
        }
        
        .style-name {
            font-weight: 600;
            font-size: 0.95rem;
        }
        
        .furniture-selection {
            margin-top: 25px;
        }
        
        .furniture-categories {
            display: flex;
            margin-bottom: 15px;
            border-bottom: 1px solid #eee;
        }
        
        .category-tab {
            padding: 10px 20px;
            cursor: pointer;
            font-weight: 600;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
        }
        
        .category-tab.active {
            color: #27ae60;
            border-bottom-color: #27ae60;
        }
        
        .furniture-items {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 15px;
            max-height: 300px;
            overflow-y: auto;
            padding: 5px;
        }
        
        .furniture-item {
            width: 90px;
            height: 90px;
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: grab;
            transition: all 0.3s;
            border: 2px solid #eee;
            background-color: #f8f9fa;
            position: relative;
        }
        
        .furniture-item:hover {
            border-color: #27ae60;
            transform: scale(1.05);
        }
        
        .furniture-item.plant-item {
            background-color: #f0f9f4;
            border-color: #c8e6c9;
        }
        
        .furniture-icon {
            font-size: 1.8rem;
            margin-bottom: 5px;
        }
        
        .furniture-name {
            font-size: 0.8rem;
            text-align: center;
        }
        
        .design-area-container {
            position: relative;
            flex-grow: 1;
            border-radius: 8px;
            margin-top: 20px;
            overflow: hidden;
            min-height: 500px;
            border: 2px dashed #ddd;
        }
        
        .design-area {
            width: 100%;
            height: 500px;
            position: relative;
            overflow: hidden;
            background-color: #f9f9f9;
        }
        
        .design-area.empty::before {
            content: "Încarcă un plan al camerei și trage mobilierul aici";
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100%;
            color: #aaa;
            font-size: 1.1rem;
            text-align: center;
            padding: 20px;
        }
        
        .room-background {
            max-width: 100%;
            max-height: 100%;
            display: none;
            position: absolute;
            top: 0;
            left: 0;
        }
        
        .furniture-placed {
            position: absolute;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: move;
            border-radius: 5px;
            transition: transform 0.2s;
            z-index: 10;
        }
        
        .furniture-placed:hover {
            transform: scale(1.05);
            z-index: 100;
        }
        
        .furniture-placed .furniture-icon {
            font-size: 1.8rem;
        }
        
        .furniture-placed .furniture-name {
            font-size: 0.75rem;
            margin-top: 5px;
            background-color: rgba(255, 255, 255, 0.8);
            padding: 2px 5px;
            border-radius: 3px;
        }
        
        #view3DContainer {
            display: none;
            width: 100%;
            height: 500px;
            position: relative;
        }
        
        .view-toggle {
            display: flex;
            margin-bottom: 15px;
            background-color: #f8f9fa;
            border-radius: 6px;
            padding: 5px;
        }
        
        .view-btn {
            flex: 1;
            padding: 10px;
            text-align: center;
            cursor: pointer;
            border-radius: 4px;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        .view-btn.active {
            background-color: #27ae60;
            color: white;
        }
        
        .view-btn:not(.active):hover {
            background-color: #e8f8f0;
        }
        
        .controls {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #eee;
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .btn-primary {
            background-color: #27ae60;
            color: white;
        }
        
        .btn-primary:hover {
            background-color: #219653;
        }
        
        .btn-secondary {
            background-color: #e0e0e0;
            color: #333;
        }
        
        .btn-secondary:hover {
            background-color: #d0d0d0;
        }
        
        .btn-success {
            background-color: #27ae60;
            color: white;
        }
        
        .btn-success:hover {
            background-color: #219653;
        }
        
        .btn-info {
            background-color: #3498db;
            color: white;
        }
        
        .btn-info:hover {
            background-color: #2980b9;
        }
        
        .instructions {
            margin-top: 30px;
            background-color: #f0f9f4;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #27ae60;
        }
        
        .instructions h3 {
            color: #2c3e50;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
        }
        
        .instructions h3 i {
            margin-right: 10px;
            color: #27ae60;
        }
        
        .instructions ol {
            padding-left: 20px;
        }
        
        .instructions li {
            margin-bottom: 8px;
        }
        
        .plant-highlight {
            color: #27ae60;
            font-weight: 600;
        }
        
        .ai-highlight {
            color: #3498db;
            font-weight: 600;
        }
        
        .three-d-highlight {
            color: #9b59b6;
            font-weight: 600;
        }
        
        footer {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            color: #7f8c8d;
            border-top: 1px solid #e0e0e0;
            font-size: 0.9rem;
        }
        
        @media (max-width: 1100px) {
            .app-container {
                flex-direction: column;
            }
        }
        
        .selected-style {
            margin-top: 15px;
            padding: 10px;
            background-color: #f8f9fa;
            border-radius: 6px;
            display: flex;
            align-items: center;
        }
        
        .stats {
            display: flex;
            justify-content: space-around;
            background-color: #f0f9f4;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .stat-item {
            text-align: center;
            flex: 1;
            min-width: 120px;
        }
        
        .stat-number {
            font-size: 2rem;
            font-weight: 700;
            color: #27ae60;
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: #555;
        }
        
        .quick-add-plants {
            margin-top: 15px;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .quick-plant-btn {
            padding: 8px 15px;
            background-color: #e8f8f0;
            border: 1px solid #c8e6c9;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 5px;
            transition: all 0.3s;
        }
        
        .quick-plant-btn:hover {
            background-color: #d4edd9;
        }
        
        .ai-suggestions {
            margin-top: 25px;
            background-color: #e8f4fc;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #3498db;
        }
        
        .ai-suggestions h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
        }
        
        .ai-suggestions h3 i {
            margin-right: 10px;
            color: #3498db;
        }
        
        .ai-suggestions-list {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .ai-suggestion-btn {
            padding: 8px 15px;
            background-color: white;
            border: 1px solid #3498db;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 5px;
            transition: all 0.3s;
        }
        
        .ai-suggestion-btn:hover {
            background-color: #d6eaf8;
        }
        
        .loading {
            display: none;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: rgba(255, 255, 255, 0.9);
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            z-index: 1000;
        }
        
        .loading-spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #27ae60;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 10px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .three-d-controls {
            position: absolute;
            bottom: 20px;
            right: 20px;
            z-index: 100;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .three-d-control-btn {
            width: 40px;
            height: 40px;
            background-color: white;
            border: 1px solid #ddd;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            transition: all 0.3s;
        }
        
        .three-d-control-btn:hover {
            background-color: #f8f9fa;
            transform: scale(1.1);
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-leaf"></i> Redecorează apartamentul</h1>
            <p class="tagline">Minimalist cu multe plante + <span class="three-d-highlight">Vizualizare 3D</span></p>
            <p class="subtitle">Încarcă planul camerelor și creează un spațiu minimalist plin de plante. <span class="ai-highlight">Nou:</span> Vizualizează designul în 3D!</p>
        </header>
        
        <div class="stats">
            <div class="stat-item">
                <div class="stat-number" id="totalPlants">0</div>
                <div class="stat-label">Plante plasate</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="totalFurniture">0</div>
                <div class="stat-label">Mobile totale</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="furnitureRatio">0:0</div>
                <div class="stat-label">Raport plante/mobile</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="threeDModels">0</div>
                <div class="stat-label">Obiecte 3D</div>
            </div>
        </div>
        
        <div class="app-container">
            <section class="upload-section">
                <h2 class="section-title"><i class="fas fa-upload"></i> 1. Încarcă planul camerei</h2>
                <div class="upload-area" id="uploadArea">
                    <div class="upload-icon">
                        <i class="fas fa-cloud-upload-alt"></i>
                    </div>
                    <div class="upload-text">
                        Click pentru a încărca o imagine cu planul camerei
                        <small>Formate acceptate: JPG, PNG, GIF (max. 5MB)</small>
                    </div>
                    <input type="file" id="roomImage" accept="image/*">
                </div>
                
                <div class="room-preview" id="roomPreview">
                    <h3>Plan încărcat:</h3>
                    <img id="previewImage" src="" alt="Room plan">
                </div>
                
                <div class="ai-suggestions">
                    <h3><i class="fas fa-robot"></i> Sugestii AI pentru plante</h3>
                    <div class="ai-suggestions-list">
                        <div class="ai-suggestion-btn" id="aiLowLight">
                            <i class="fas fa-moon"></i> Plante pentru lumină redusă
                        </div>
                        <div class="ai-suggestion-btn" id="aiPetFriendly">
                            <i class="fas fa-paw"></i> Plante sigure pentru animale
                        </div>
                        <div class="ai-suggestion-btn" id="aiAirPurifying">
                            <i class="fas fa-wind"></i> Plante care purifică aerul
                        </div>
                        <div class="ai-suggestion-btn" id="aiEasyCare">
                            <i class="fas fa-tint-slash"></i> Plante cu întreținere ușoară
                        </div>
                    </div>
                </div>
                
                <div class="style-selection">
                    <h2 class="section-title"><i class="fas fa-palette"></i> 2. Alege un stil minimalist</h2>
                    <div class="style-options">
                        <div class="style-option active" data-style="minimalist">
                            <div class="style-icon"><i class="fas fa-border-style"></i></div>
                            <div class="style-name">Minimalist</div>
                        </div>
                        <div class="style-option" data-style="scandinavian">
                            <div class="style-icon"><i class="fas fa-snowflake"></i></div>
                            <div class="style-name">Scandinavian</div>
                        </div>
                        <div class="style-option" data-style="japanese">
                            <div class="style-icon"><i class="fas fa-mountain"></i></div>
                            <div class="style-name">Japonez</div>
                        </div>
                        <div class="style-option" data-style="bohemian">
                            <div class="style-icon"><i class="fas fa-feather-alt"></i></div>
                            <div class="style-name">Bohemian Green</div>
                        </div>
                    </div>
                    
                    <div class="quick-add-plants">
                        <div class="quick-plant-btn" id="addPlantGroup">
                            <i class="fas fa-plus"></i> Adaugă 3 plante
                        </div>
                        <div class="quick-plant-btn" id="addPlantWall">
                            <i class="fas fa-plus"></i> Plante pe perete
                        </div>
                        <div class="quick-plant-btn" id="addPlantCorner">
                            <i class="fas fa-plus"></i> Colț cu plante
                        </div>
                    </div>
                </div>
                
                <div class="furniture-selection">
                    <h2 class="section-title"><i class="fas fa-couch"></i> 3. Selectează mobilier (puțin)</h2>
                    
                    <div class="furniture-categories">
                        <div class="category-tab active" data-category="plants">Plante</div>
                        <div class="category-tab" data-category="essential">Esențiale</div>
                        <div class="category-tab" data-category="decor">Decor</div>
                    </div>
                    
                    <div class="furniture-items" id="plantsTab">
                        <div class="furniture-item plant-item" data-type="plant-large" data-icon="fas fa-seedling" data-category="plants">
                            <div class="furniture-icon"><i class="fas fa-seedling"></i></div>
                            <div class="furniture-name">Plantă mare</div>
                        </div>
                        <div class="furniture-item plant-item" data-type="plant-medium" data-icon="fas fa-leaf" data-category="plants">
                            <div class="furniture-icon"><i class="fas fa-leaf"></i></div>
                            <div class="furniture-name">Plantă medie</div>
                        </div>
                        <div class="furniture-item plant-item" data-type="plant-small" data-icon="fas fa-spa" data-category="plants">
                            <div class="furniture-icon"><i class="fas fa-spa"></i></div>
                            <div class="furniture-name">Plantă mică</div>
                        </div>
                        <div class="furniture-item plant-item" data-type="plant-hanging" data-icon="fas fa-tree" data-category="plants">
                            <div class="furniture-icon"><i class="fas fa-tree"></i></div>
                            <div class="furniture-name">Plantă agățată</div>
                        </div>
                        <div class="furniture-item plant-item" data-type="succulent" data-icon="fas fa-pagelines" data-category="plants">
                            <div class="furniture-icon"><i class="fas fa-pagelines"></i></div>
                            <div class="furniture-name">Succulentă</div>
                        </div>
                        <div class="furniture-item plant-item" data-type="plant-wall" data-icon="fas fa-th-large" data-category="plants">
                            <div class="furniture-icon"><i class="fas fa-th-large"></i></div>
                            <div class="furniture-name">Perete verde</div>
                        </div>
                        <div class="furniture-item plant-item" data-type="plant-corner" data-icon="fas fa-vector-square" data-category="plants">
                            <div class="furniture-icon"><i class="fas fa-vector-square"></i></div>
                            <div class="furniture-name">Colț verde</div>
                        </div>
                        <div class="furniture-item plant-item" data-type="plant-stand" data-icon="fas fa-chevron-up" data-category="plants">
                            <div class="furniture-icon"><i class="fas fa-chevron-up"></i></div>
                            <div class="furniture-name">Suvită plante</div>
                        </div>
                    </div>
                    
                    <div class="furniture-items" id="essentialTab" style="display: none;">
                        <div class="furniture-item" data-type="sofa" data-icon="fas fa-couch" data-category="essential">
                            <div class="furniture-icon"><i class="fas fa-couch"></i></div>
                            <div class="furniture-name">Scaun simplu</div>
                        </div>
                        <div class="furniture-item" data-type="bed" data-icon="fas fa-bed" data-category="essential">
                            <div class="furniture-icon"><i class="fas fa-bed"></i></div>
                            <div class="furniture-name">Pat minimalist</div>
                        </div>
                        <div class="furniture-item" data-type="table" data-icon="fas fa-square" data-category="essential">
                            <div class="furniture-icon"><i class="fas fa-square"></i></div>
                            <div class="furniture-name">Masă mică</div>
                        </div>
                        <div class="furniture-item" data-type="chair" data-icon="fas fa-chair" data-category="essential">
                            <div class="furniture-icon"><i class="fas fa-chair"></i></div>
                            <div class="furniture-name">Scaun</div>
                        </div>
                        <div class="furniture-item" data-type="storage" data-icon="fas fa-box" data-category="essential">
                            <div class="furniture-icon"><i class="fas fa-box"></i></div>
                            <div class="furniture-name">Dulap simplu</div>
                        </div>
                    </div>
                    
                    <div class="furniture-items" id="decorTab" style="display: none;">
                        <div class="furniture-item" data-type="lamp" data-icon="fas fa-lightbulb" data-category="decor">
                            <div class="furniture-icon"><i class="fas fa-lightbulb"></i></div>
                            <div class="furniture-name">Lampă simplă</div>
                        </div>
                        <div class="furniture-item" data-type="rug" data-icon="fas fa-square-full" data-category="decor">
                            <div class="furniture-icon"><i class="fas fa-square-full"></i></div>
                            <div class="furniture-name">Covoar simplu</div>
                        </div>
                        <div class="furniture-item" data-type="shelf" data-icon="fas fa-bars" data-category="decor">
                            <div class="furniture-icon"><i class="fas fa-bars"></i></div>
                            <div class="furniture-name">Raft minimalist</div>
                        </div>
                        <div class="furniture-item" data-type="mirror" data-icon="fas fa-expand-alt" data-category="decor">
                            <div class="furniture-icon"><i class="fas fa-expand-alt"></i></div>
                            <div class="furniture-name">Oglindă simplă</div>
                        </div>
                    </div>
                </div>
            </section>
            
            <section class="design-section">
                <h2 class="section-title"><i class="fas fa-paint-brush"></i> 4. Zone de decorare minimalistă</h2>
                
                <div class="view-toggle">
                    <div class="view-btn active" id="view2DBtn">
                        <i class="fas fa-border-all"></i> Vizualizare 2D
                    </div>
                    <div class="view-btn" id="view3DBtn">
                        <i class="fas fa-cube"></i> Vizualizare 3D
                    </div>
                </div>
                
                <div class="design-area-container">
                    <div class="design-area empty" id="designArea">
                        <img class="room-background" id="roomBackground" src="" alt="Room background">
                    </div>
                    
                    <div id="view3DContainer"></div>
                    
                    <div class="loading" id="loading3D">
                        <div class="loading-spinner"></div>
                        <p>Se încarcă vizualizarea 3D...</p>
                    </div>
                </div>
                
                <div class="controls">
                    <button class="btn btn-secondary" id="clearBtn">
                        <i class="fas fa-trash-alt"></i> Șterge tot
                    </button>
                    <button class="btn btn-info" id="toggle3DBtn">
                        <i class="fas fa-cube"></i> Generează 3D
                    </button>
                    <button class="btn btn-success" id="saveBtn">
                        <i class="fas fa-save"></i> Salvează designul
                    </button>
                </div>
            </section>
        </div>
        
        <div class="instructions">
            <h3><i class="fas fa-info-circle"></i> Cum creezi un spațiu minimalist cu multe plante:</h3>
            <ol>
                <li>Încarcă planul camerei tale</li>
                <li>Folosește <span class="ai-highlight">sugestiile AI</span> pentru plante potrivite</li>
                <li>Alege un stil minimalist și folosește mai mult <span class="plant-highlight">plante</span></li>
                <li>Trage plantele în zona de decorare</li>
                <li>Apasă <span class="three-d-highlight">"Generează 3D"</span> pentru a vedea designul în 3D</li>
                <li>Comută între vizualizările 2D și 3D pentru a vedea designul din diferite unghiuri</li>
                <li>Salvează designul când ești mulțumit</li>
            </ol>
            <p style="margin-top: 10px;"><strong>Țintă ideală:</strong> cel puțin 2 plante pentru fiecare mobilă esențială.</p>
        </div>
        
        <footer>
            <p>Redecorează apartamentul - Minimalist cu Plante. Vizualizare 3D inclusă gratuit</p>
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // DOM elements
            const uploadArea = document.getElementById('uploadArea');
            const roomImageInput = document.getElementById('roomImage');
            const roomPreview = document.getElementById('roomPreview');
            const previewImage = document.getElementById('previewImage');
            const roomBackground = document.getElementById('roomBackground');
            const designArea = document.getElementById('designArea');
            const styleOptions = document.querySelectorAll('.style-option');
            const categoryTabs = document.querySelectorAll('.category-tab');
            const furnitureItems = document.querySelectorAll('.furniture-item');
            const clearBtn = document.getElementById('clearBtn');
            const saveBtn = document.getElementById('saveBtn');
            const toggle3DBtn = document.getElementById('toggle3DBtn');
            const view2DBtn = document.getElementById('view2DBtn');
            const view3DBtn = document.getElementById('view3DBtn');
            const view3DContainer = document.getElementById('view3DContainer');
            const loading3D = document.getElementById('loading3D');
            const totalPlantsElement = document.getElementById('totalPlants');
            const totalFurnitureElement = document.getElementById('totalFurniture');
            const furnitureRatioElement = document.getElementById('furnitureRatio');
            const threeDModelsElement = document.getElementById('threeDModels');
            const addPlantGroupBtn = document.getElementById('addPlantGroup');
            const addPlantWallBtn = document.getElementById('addPlantWall');
            const addPlantCornerBtn = document.getElementById('addPlantCorner');
            
            // AI suggestion buttons
            const aiLowLightBtn = document.getElementById('aiLowLight');
            const aiPetFriendlyBtn = document.getElementById('aiPetFriendly');
            const aiAirPurifyingBtn = document.getElementById('aiAirPurifying');
            const aiEasyCareBtn = document.getElementById('aiEasyCare');
            
            // App state
            let selectedStyle = 'minimalist';
            let selectedFurniture = null;
            let furnitureCounter = 0;
            let plantCount = 0;
            let essentialCount = 0;
            let threeDModelsCount = 0;
            let threeDScene = null;
            let threeDCamera = null;
            let threeDRenderer = null;
            let threeDObjects = [];
            let is3DViewActive = false;
            
            // Style color mapping
            const styleColors = {
                minimalist: '#27ae60',
                scandinavian: '#3498db',
                japanese: '#e74c3c',
                bohemian: '#9b59b6'
            };
            
            // Style display names
            const styleNames = {
                minimalist: 'Minimalist',
                scandinavian: 'Scandinavian',
                japanese: 'Japonez',
                bohemian: 'Bohemian Green'
            };
            
            // AI plant suggestions
            const aiSuggestions = {
                lowLight: [
                    { type: 'plant-medium', icon: 'fas fa-leaf', name: 'Liriop' },
                    { type: 'plant-small', icon: 'fas fa-spa', name: 'Pothos' },
                    { type: 'plant-large', icon: 'fas fa-seedling', name: 'Dracena' },
                    { type: 'succulent', icon: 'fas fa-pagelines', name: 'Sansevieria' }
                ],
                petFriendly: [
                    { type: 'plant-medium', icon: 'fas fa-leaf', name: 'Calathea' },
                    { type: 'plant-small', icon: 'fas fa-spa', name: 'Pilea' },
                    { type: 'plant-hanging', icon: 'fas fa-tree', name: 'Cățelușa' },
                    { type: 'plant-large', icon: 'fas fa-seedling', name: 'Palmier' }
                ],
                airPurifying: [
                    { type: 'plant-large', icon: 'fas fa-seedling', name: 'Ficus' },
                    { type: 'plant-medium', icon: 'fas fa-leaf', name: 'Liriop' },
                    { type: 'plant-small', icon: 'fas fa-spa', name: 'Spider Plant' },
                    { type: 'plant-hanging', icon: 'fas fa-tree', name: 'Iedera' }
                ],
                easyCare: [
                    { type: 'succulent', icon: 'fas fa-pagelines', name: 'Succulente' },
                    { type: 'plant-small', icon: 'fas fa-spa', name: 'ZZ Plant' },
                    { type: 'plant-medium', icon: 'fas fa-leaf', name: 'Aloe Vera' },
                    { type: 'plant-hanging', icon: 'fas fa-tree', name: 'Suculentă agățată' }
                ]
            };
            
            // Initialize the app
            function init() {
                // Set minimalist as default selected style
                document.querySelector('.style-option[data-style="minimalist"]').classList.add('active');
                
                // Set up event listeners
                setupEventListeners();
                
                // Update stats initially
                updateStats();
            }
            
            // Set up all event listeners
            function setupEventListeners() {
                // Upload area click event
                uploadArea.addEventListener('click', () => roomImageInput.click());
                
                // Room image upload event
                roomImageInput.addEventListener('change', handleRoomImageUpload);
                
                // Style selection events
                styleOptions.forEach(option => {
                    option.addEventListener('click', handleStyleSelection);
                });
                
                // Category tab events
                categoryTabs.forEach(tab => {
                    tab.addEventListener('click', handleCategoryTabClick);
                });
                
                // Furniture selection events
                furnitureItems.forEach(item => {
                    item.addEventListener('mousedown', handleFurnitureSelection);
                    item.addEventListener('touchstart', handleFurnitureSelection);
                });
                
                // Design area events
                designArea.addEventListener('dragover', handleDragOver);
                designArea.addEventListener('drop', handleDrop);
                designArea.addEventListener('click', handleDesignAreaClick);
                
                // Control buttons
                clearBtn.addEventListener('click', clearAllFurniture);
                saveBtn.addEventListener('click', saveDesign);
                toggle3DBtn.addEventListener('click', generate3DView);
                
                // View toggle buttons
                view2DBtn.addEventListener('click', () => switchView('2D'));
                view3DBtn.addEventListener('click', () => switchView('3D'));
                
                // Quick add plant buttons
                addPlantGroupBtn.addEventListener('click', () => addPlantGroup());
                addPlantWallBtn.addEventListener('click', () => addPlantWall());
                addPlantCornerBtn.addEventListener('click', () => addPlantCorner());
                
                // AI suggestion buttons
                aiLowLightBtn.addEventListener('click', () => applyAISuggestion('lowLight'));
                aiPetFriendlyBtn.addEventListener('click', () => applyAISuggestion('petFriendly'));
                aiAirPurifyingBtn.addEventListener('click', () => applyAISuggestion('airPurifying'));
                aiEasyCareBtn.addEventListener('click', () => applyAISuggestion('easyCare'));
            }
            
            // Handle room image upload
            function handleRoomImageUpload(event) {
                const file = event.target.files[0];
                if (!file) return;
                
                // Check file size (max 5MB)
                if (file.size > 5 * 1024 * 1024) {
                    alert('Fișierul este prea mare. Te rog alege un fișier mai mic de 5MB.');
                    return;
                }
                
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    const imageUrl = e.target.result;
                    
                    // Show preview
                    previewImage.src = imageUrl;
                    roomPreview.style.display = 'block';
                    
                    // Set as background in design area
                    roomBackground.src = imageUrl;
                    roomBackground.style.display = 'block';
                    designArea.classList.remove('empty');
                    
                    // Scroll to design area
                    designArea.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                };
                
                reader.readAsDataURL(file);
            }
            
            // Handle style selection
            function handleStyleSelection(event) {
                const styleElement = event.currentTarget;
                const style = styleElement.getAttribute('data-style');
                
                // Remove active class from all style options
                styleOptions.forEach(option => {
                    option.classList.remove('active');
                });
                
                // Add active class to selected style
                styleElement.classList.add('active');
                
                // Update selected style
                selectedStyle = style;
                
                // Update furniture colors based on selected style
                updateFurnitureColors(style);
            }
            
            // Handle category tab click
            function handleCategoryTabClick(event) {
                const tab = event.currentTarget;
                const category = tab.getAttribute('data-category');
                
                // Remove active class from all tabs
                categoryTabs.forEach(t => {
                    t.classList.remove('active');
                });
                
                // Add active class to selected tab
                tab.classList.add('active');
                
                // Show corresponding furniture tab
                document.querySelectorAll('.furniture-items').forEach(items => {
                    items.style.display = 'none';
                });
                
                document.getElementById(`${category}Tab`).style.display = 'flex';
            }
            
            // Update furniture colors based on selected style
            function updateFurnitureColors(style) {
                furnitureItems.forEach(item => {
                    const icon = item.querySelector('.furniture-icon i');
                    icon.style.color = styleColors[style];
                });
            }
            
            // Apply AI suggestion
            function applyAISuggestion(suggestionType) {
                if (designArea.classList.contains('empty')) {
                    alert('Te rog încarcă mai întâi un plan al camerei.');
                    return;
                }
                
                const suggestions = aiSuggestions[suggestionType];
                const rect = designArea.getBoundingClientRect();
                const centerX = rect.width / 2;
                const centerY = rect.height / 2;
                
                // Clear existing plants first
                const existingPlants = document.querySelectorAll('.furniture-placed[data-category="plants"]');
                existingPlants.forEach(plant => {
                    if (plant.getAttribute('data-category') === 'plants') {
                        plant.remove();
                    }
                });
                
                // Reset plant count
                plantCount = 0;
                
                // Add suggested plants
                suggestions.forEach((plant, index) => {
                    setTimeout(() => {
                        const x = centerX - 100 + (index % 2) * 80;
                        const y = centerY - 50 + Math.floor(index / 2) * 80;
                        
                        selectedFurniture = {
                            type: plant.type,
                            icon: plant.icon,
                            color: styleColors[selectedStyle],
                            category: 'plants',
                            name: plant.name
                        };
                        
                        placeFurniture(x, y);
                    }, index * 300);
                });
                
                // Show confirmation
                let suggestionName = '';
                switch(suggestionType) {
                    case 'lowLight': suggestionName = 'pentru lumină redusă'; break;
                    case 'petFriendly': suggestionName = 'sigure pentru animale'; break;
                    case 'airPurifying': suggestionName = 'care purifică aerul'; break;
                    case 'easyCare': suggestionName = 'cu întreținere ușoară'; break;
                }
                
                alert(`Am adăugat plante ${suggestionName}. Aceste plante sunt ideale pentru un spațiu minimalist!`);
            }
            
            // Handle furniture selection
            function handleFurnitureSelection(event) {
                event.preventDefault();
                
                const furnitureElement = event.currentTarget;
                const type = furnitureElement.getAttribute('data-type');
                const iconClass = furnitureElement.getAttribute('data-icon');
                const category = furnitureElement.getAttribute('data-category');
                
                selectedFurniture = {
                    type: type,
                    icon: iconClass,
                    color: styleColors[selectedStyle],
                    category: category
                };
                
                // Add visual feedback for selected furniture
                furnitureItems.forEach(item => {
                    item.style.borderColor = item.classList.contains('plant-item') ? '#c8e6c9' : '#eee';
                });
                furnitureElement.style.borderColor = '#27ae60';
                
                // If design area is empty (no room image), show a message
                if (designArea.classList.contains('empty')) {
                    alert('Te rog încarcă mai întâi un plan al camerei înainte de a plasa mobilierul.');
                }
            }
            
            // Handle drag over design area
            function handleDragOver(event) {
                event.preventDefault();
                event.dataTransfer.dropEffect = 'copy';
            }
            
            // Handle drop in design area
            function handleDrop(event) {
                event.preventDefault();
                
                if (!selectedFurniture) {
                    alert('Te rog selectează mai întâi un mobilier din lista de mobilier.');
                    return;
                }
                
                const rect = designArea.getBoundingClientRect();
                const x = event.clientX - rect.left;
                const y = event.clientY - rect.top;
                
                placeFurniture(x, y);
            }
            
            // Handle click in design area
            function handleDesignAreaClick(event) {
                if (!selectedFurniture) return;
                
                const rect = designArea.getBoundingClientRect();
                const x = event.clientX - rect.left;
                const y = event.clientY - rect.top;
                
                // Check if click is within the design area
                if (x >= 0 && x <= rect.width && y >= 0 && y <= rect.height) {
                    placeFurniture(x, y);
                }
            }
            
            // Place furniture in design area
            function placeFurniture(x, y) {
                furnitureCounter++;
                
                const furniture = document.createElement('div');
                furniture.className = 'furniture-placed';
                furniture.id = `furniture-${furnitureCounter}`;
                furniture.style.left = `${x}px`;
                furniture.style.top = `${y}px`;
                furniture.style.color = selectedFurniture.color;
                furniture.setAttribute('data-type', selectedFurniture.type);
                furniture.setAttribute('data-category', selectedFurniture.category);
                
                furniture.innerHTML = `
                    <div class="furniture-icon"><i class="${selectedFurniture.icon}"></i></div>
                    <div class="furniture-name">${selectedFurniture.name || selectedFurniture.type}</div>
                `;
                
                // Make furniture draggable
                makeDraggable(furniture);
                
                // Add to design area
                designArea.appendChild(furniture);
                
                // Update counts based on category
                if (selectedFurniture.category === 'plants') {
                    plantCount++;
                } else if (selectedFurniture.category === 'essential') {
                    essentialCount++;
                }
                
                // Update stats
                updateStats();
            }
            
            // Make furniture element draggable
            function makeDraggable(element) {
                let isDragging = false;
                let currentX;
                let currentY;
                let initialX;
                let initialY;
                let xOffset = 0;
                let yOffset = 0;
                
                element.addEventListener('mousedown', dragStart);
                element.addEventListener('touchstart', dragStart);
                
                function dragStart(e) {
                    if (e.type === 'touchstart') {
                        initialX = e.touches[0].clientX - xOffset;
                        initialY = e.touches[0].clientY - yOffset;
                    } else {
                        initialX = e.clientX - xOffset;
                        initialY = e.clientY - yOffset;
                    }
                    
                    if (e.target === element || element.contains(e.target)) {
                        isDragging = true;
                        element.style.cursor = 'grabbing';
                        element.style.zIndex = '1000';
                    }
                    
                    document.addEventListener('mousemove', drag);
                    document.addEventListener('touchmove', drag);
                    document.addEventListener('mouseup', dragEnd);
                    document.addEventListener('touchend', dragEnd);
                }
                
                function drag(e) {
                    if (isDragging) {
                        e.preventDefault();
                        
                        if (e.type === 'touchmove') {
                            currentX = e.touches[0].clientX - initialX;
                            currentY = e.touches[0].clientY - initialY;
                        } else {
                            currentX = e.clientX - initialX;
                            currentY = e.clientY - initialY;
                        }
                        
                        xOffset = currentX;
                        yOffset = currentY;
                        
                        setTranslate(currentX, currentY, element);
                    }
                }
                
                function dragEnd() {
                    initialX = currentX;
                    initialY = currentY;
                    
                    isDragging = false;
                    element.style.cursor = 'move';
                    element.style.zIndex = '10';
                    
                    document.removeEventListener('mousemove', drag);
                    document.removeEventListener('touchmove', drag);
                    document.removeEventListener('mouseup', dragEnd);
                    document.removeEventListener('touchend', dragEnd);
                }
                
                function setTranslate(xPos, yPos, el) {
                    el.style.transform = `translate3d(${xPos}px, ${yPos}px, 0)`;
                }
            }
            
            // Update statistics
            function updateStats() {
                const totalFurniture = plantCount + essentialCount;
                const ratio = essentialCount > 0 ? `${plantCount}:${essentialCount}` : `${plantCount}:0`;
                
                totalPlantsElement.textContent = plantCount;
                totalFurnitureElement.textContent = totalFurniture;
                furnitureRatioElement.textContent = ratio;
                threeDModelsElement.textContent = threeDModelsCount;
                
                // Visual feedback for good plant-to-furniture ratio
                if (plantCount >= essentialCount * 2 && essentialCount > 0) {
                    furnitureRatioElement.style.color = '#27ae60';
                } else if (plantCount > essentialCount && essentialCount > 0) {
                    furnitureRatioElement.style.color = '#f39c12';
                } else {
                    furnitureRatioElement.style.color = '#e74c3c';
                }
            }
            
            // Add a group of plants
            function addPlantGroup() {
                if (designArea.classList.contains('empty')) {
                    alert('Te rog încarcă mai întâi un plan al camerei.');
                    return;
                }
                
                const rect = designArea.getBoundingClientRect();
                const centerX = rect.width / 2;
                const centerY = rect.height / 2;
                
                // Create 3 plants in a small group
                const plantTypes = ['plant-large', 'plant-medium', 'plant-small'];
                const plantIcons = ['fas fa-seedling', 'fas fa-leaf', 'fas fa-spa'];
                
                for (let i = 0; i < 3; i++) {
                    setTimeout(() => {
                        const x = centerX - 50 + Math.random() * 100;
                        const y = centerY - 50 + Math.random() * 100;
                        
                        selectedFurniture = {
                            type: plantTypes[i],
                            icon: plantIcons[i],
                            color: styleColors[selectedStyle],
                            category: 'plants'
                        };
                        
                        placeFurniture(x, y);
                    }, i * 100);
                }
            }
            
            // Add a plant wall
            function addPlantWall() {
                if (designArea.classList.contains('empty')) {
                    alert('Te rog încarcă mai întâi un plan al camerei.');
                    return;
                }
                
                const rect = designArea.getBoundingClientRect();
                const wallX = 50; // Near left wall
                
                // Create 4 plants in a vertical line (wall arrangement)
                for (let i = 0; i < 4; i++) {
                    setTimeout(() => {
                        const y = 100 + i * 80;
                        
                        selectedFurniture = {
                            type: 'plant-hanging',
                            icon: 'fas fa-tree',
                            color: styleColors[selectedStyle],
                            category: 'plants'
                        };
                        
                        placeFurniture(wallX, y);
                    }, i * 100);
                }
            }
            
            // Add a plant corner
            function addPlantCorner() {
                if (designArea.classList.contains('empty')) {
                    alert('Te rog încarcă mai întâi un plan al camerei.');
                    return;
                }
                
                const rect = designArea.getBoundingClientRect();
                const cornerX = rect.width - 100; // Near right wall
                const cornerY = rect.height - 150; // Near bottom
                
                // Create 3 plants in a corner arrangement
                const cornerPlants = [
                    {type: 'plant-corner', icon: 'fas fa-vector-square', x: cornerX, y: cornerY},
                    {type: 'plant-medium', icon: 'fas fa-leaf', x: cornerX - 60, y: cornerY - 40},
                    {type: 'plant-small', icon: 'fas fa-spa', x: cornerX - 30, y: cornerY - 80}
                ];
                
                cornerPlants.forEach((plant, i) => {
                    setTimeout(() => {
                        selectedFurniture = {
                            type: plant.type,
                            icon: plant.icon,
                            color: styleColors[selectedStyle],
                            category: 'plants'
                        };
                        
                        placeFurniture(plant.x, plant.y);
                    }, i * 100);
                });
            }
            
            // Clear all furniture from design area
            function clearAllFurniture() {
                const placedFurniture = document.querySelectorAll('.furniture-placed');
                
                if (placedFurniture.length === 0) {
                    alert('Nu există mobilier de șters.');
                    return;
                }
                
                if (confirm('Sigur dorești să ștergi tot mobilierul?')) {
                    placedFurniture.forEach(item => {
                        item.remove();
                    });
                    
                    // Reset counters
                    plantCount = 0;
                    essentialCount = 0;
                    threeDModelsCount = 0;
                    
                    // Clear 3D scene if exists
                    if (threeDScene) {
                        threeDObjects.forEach(obj => {
                            threeDScene.remove(obj);
                        });
                        threeDObjects = [];
                    }
                    
                    updateStats();
                }
            }
            
            // Switch between 2D and 3D views
            function switchView(viewType) {
                if (viewType === '2D') {
                    designArea.style.display = 'block';
                    view3DContainer.style.display = 'none';
                    view2DBtn.classList.add('active');
                    view3DBtn.classList.remove('active');
                    is3DViewActive = false;
                } else if (viewType === '3D') {
                    if (threeDScene === null) {
                        alert('Mai întâi generează vizualizarea 3D folosind butonul "Generează 3D".');
                        view2DBtn.classList.add('active');
                        view3DBtn.classList.remove('active');
                        return;
                    }
                    
                    designArea.style.display = 'none';
                    view3DContainer.style.display = 'block';
                    view2DBtn.classList.remove('active');
                    view3DBtn.classList.add('active');
                    is3DViewActive = true;
                }
            }
            
            // Generate 3D view from current design
            function generate3DView() {
                if (designArea.classList.contains('empty')) {
                    alert('Te rog încarcă un plan al camerei înainte de a genera vizualizarea 3D.');
                    return;
                }
                
                const placedFurniture = document.querySelectorAll('.furniture-placed');
                
                if (placedFurniture.length === 0) {
                    alert('Adaugă cel puțin un mobilier în cameră înainte de a genera vizualizarea 3D.');
                    return;
                }
                
                // Show loading
                loading3D.style.display = 'block';
                
                // Initialize 3D scene if not already initialized
                if (threeDScene === null) {
                    init3DScene();
                } else {
                    // Clear existing 3D objects
                    threeDObjects.forEach(obj => {
                        threeDScene.remove(obj);
                    });
                    threeDObjects = [];
                }
                
                // Create 3D objects for each furniture piece
                setTimeout(() => {
                    placedFurniture.forEach((furniture, index) => {
                        const type = furniture.getAttribute('data-type');
                        const category = furniture.getAttribute('data-category');
                        
                        create3DObject(type, category, index);
                    });
                    
                    // Update 3D models count
                    threeDModelsCount = placedFurniture.length;
                    updateStats();
                    
                    // Hide loading and switch to 3D view
                    loading3D.style.display = 'none';
                    
                    // Switch to 3D view
                    switchView('3D');
                    
                    alert(`Vizualizarea 3D a fost generată cu succes! ${threeDModelsCount} obiecte au fost create.`);
                }, 1500);
            }
            
            // Initialize 3D scene
            function init3DScene() {
                // Get container dimensions
                const width = view3DContainer.clientWidth;
                const height = 500; // Fixed height
                
                // Create scene
                threeDScene = new THREE.Scene();
                threeDScene.background = new THREE.Color(0xf0f0f0);
                
                // Create camera
                threeDCamera = new THREE.PerspectiveCamera(75, width / height, 0.1, 1000);
                threeDCamera.position.set(10, 8, 12);
                threeDCamera.lookAt(0, 0, 0);
                
                // Create renderer
                threeDRenderer = new THREE.WebGLRenderer({ antialias: true });
                threeDRenderer.setSize(width, height);
                threeDRenderer.shadowMap.enabled = true;
                threeDRenderer.shadowMap.type = THREE.PCFSoftShadowMap;
                
                // Clear previous content
                view3DContainer.innerHTML = '';
                view3DContainer.appendChild(threeDRenderer.domElement);
                
                // Add lights
                const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
                threeDScene.add(ambientLight);
                
                const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
                directionalLight.position.set(10, 20, 5);
                directionalLight.castShadow = true;
                directionalLight.shadow.mapSize.width = 2048;
                directionalLight.shadow.mapSize.height = 2048;
                threeDScene.add(directionalLight);
                
                // Add floor
                const floorGeometry = new THREE.PlaneGeometry(20, 20);
                const floorMaterial = new THREE.MeshPhongMaterial({ 
                    color: 0xeeeeee,
                    side: THREE.DoubleSide
                });
                const floor = new THREE.Mesh(floorGeometry, floorMaterial);
                floor.rotation.x = Math.PI / 2;
                floor.position.y = -0.5;
                floor.receiveShadow = true;
                threeDScene.add(floor);
                
                // Add grid helper
                const gridHelper = new THREE.GridHelper(20, 20, 0xcccccc, 0xcccccc);
                gridHelper.position.y = -0.49;
                threeDScene.add(gridHelper);
                
                // Add walls (simple room)
                const wallMaterial = new THREE.MeshPhongMaterial({ 
                    color: 0xf5f5f5,
                    transparent: true,
                    opacity: 0.8
                });
                
                // Back wall
                const backWall = new THREE.Mesh(
                    new THREE.PlaneGeometry(20, 10),
                    wallMaterial
                );
                backWall.position.z = -10;
                backWall.position.y = 4.5;
                threeDScene.add(backWall);
                
                // Side walls
                const leftWall = new THREE.Mesh(
                    new THREE.PlaneGeometry(20, 10),
                    wallMaterial
                );
                leftWall.rotation.y = Math.PI / 2;
                leftWall.position.x = -10;
                leftWall.position.y = 4.5;
                threeDScene.add(leftWall);
                
                const rightWall = new THREE.Mesh(
                    new THREE.PlaneGeometry(20, 10),
                    wallMaterial
                );
                rightWall.rotation.y = -Math.PI / 2;
                rightWall.position.x = 10;
                rightWall.position.y = 4.5;
                threeDScene.add(rightWall);
                
                // Add 3D controls UI
                add3DControls();
                
                // Start animation
                animate3D();
            }
            
            // Create 3D object based on furniture type
            function create3DObject(type, category, index) {
                let object;
                let color;
                
                // Set color based on category
                if (category === 'plants') {
                    color = 0x27ae60; // Green for plants
                } else if (category === 'essential') {
                    color = 0x8b4513; // Brown for essential furniture
                } else {
                    color = 0x3498db; // Blue for decor
                }
                
                // Create different 3D objects based on type
                switch(type) {
                    case 'plant-large':
                        const plantGeometry = new THREE.ConeGeometry(1, 3, 8);
                        const plantMaterial = new THREE.MeshPhongMaterial({ color: color });
                        object = new THREE.Mesh(plantGeometry, plantMaterial);
                        object.position.set(
                            (index % 5) * 3 - 6,
                            1.5,
                            Math.floor(index / 5) * 3 - 6
                        );
                        break;
                        
                    case 'plant-medium':
                        const mediumPlantGeometry = new THREE.ConeGeometry(0.7, 2, 6);
                        const mediumPlantMaterial = new THREE.MeshPhongMaterial({ color: color });
                        object = new THREE.Mesh(mediumPlantGeometry, mediumPlantMaterial);
                        object.position.set(
                            (index % 5) * 3 - 6,
                            1,
                            Math.floor(index / 5) * 3 - 6
                        );
                        break;
                        
                    case 'plant-small':
                        const smallPlantGeometry = new THREE.ConeGeometry(0.5, 1.5, 6);
                        const smallPlantMaterial = new THREE.MeshPhongMaterial({ color: color });
                        object = new THREE.Mesh(smallPlantGeometry, smallPlantMaterial);
                        object.position.set(
                            (index % 5) * 3 - 6,
                            0.75,
                            Math.floor(index / 5) * 3 - 6
                        );
                        break;
                        
                    case 'sofa':
                    case 'bed':
                        const sofaGeometry = new THREE.BoxGeometry(3, 1, 1.5);
                        const sofaMaterial = new THREE.MeshPhongMaterial({ color: color });
                        object = new THREE.Mesh(sofaGeometry, sofaMaterial);
                        object.position.set(
                            (index % 5) * 3 - 6,
                            0.5,
                            Math.floor(index / 5) * 3 - 6
                        );
                        break;
                        
                    case 'table':
                        const tableGeometry = new THREE.BoxGeometry(1.5, 1, 1.5);
                        const tableMaterial = new THREE.MeshPhongMaterial({ color: color });
                        object = new THREE.Mesh(tableGeometry, tableMaterial);
                        object.position.set(
                            (index % 5) * 3 - 6,
                            0.5,
                            Math.floor(index / 5) * 3 - 6
                        );
                        break;
                        
                    default:
                        // Default cube for other items
                        const defaultGeometry = new THREE.BoxGeometry(1, 1, 1);
                        const defaultMaterial = new THREE.MeshPhongMaterial({ color: color });
                        object = new THREE.Mesh(defaultGeometry, defaultMaterial);
                        object.position.set(
                            (index % 5) * 3 - 6,
                            0.5,
                            Math.floor(index / 5) * 3 - 6
                        );
                }
                
                // Enable shadows
                object.castShadow = true;
                object.receiveShadow = true;
                
                // Add to scene and objects array
                threeDScene.add(object);
                threeDObjects.push(object);
            }
            
            // Add 3D controls
            function add3DControls() {
                const controlsDiv = document.createElement('div');
                controlsDiv.className = 'three-d-controls';
                
                // Rotate left button
                const rotateLeftBtn = document.createElement('div');
                rotateLeftBtn.className = 'three-d-control-btn';
                rotateLeftBtn.innerHTML = '<i class="fas fa-undo"></i>';
                rotateLeftBtn.title = 'Rotește la stânga';
                rotateLeftBtn.addEventListener('click', () => {
                    threeDScene.rotation.y += 0.2;
                });
                
                // Rotate right button
                const rotateRightBtn = document.createElement('div');
                rotateRightBtn.className = 'three-d-control-btn';
                rotateRightBtn.innerHTML = '<i class="fas fa-redo"></i>';
                rotateRightBtn.title = 'Rotește la dreapta';
                rotateRightBtn.addEventListener('click', () => {
                    threeDScene.rotation.y -= 0.2;
                });
                
                // Zoom in button
                const zoomInBtn = document.createElement('div');
                zoomInBtn.className = 'three-d-control-btn';
                zoomInBtn.innerHTML = '<i class="fas fa-search-plus"></i>';
                zoomInBtn.title = 'Zoom in';
                zoomInBtn.addEventListener('click', () => {
                    threeDCamera.position.multiplyScalar(0.9);
                });
                
                // Zoom out button
                const zoomOutBtn = document.createElement('div');
                zoomOutBtn.className = 'three-d-control-btn';
                zoomOutBtn.innerHTML = '<i class="fas fa-search-minus"></i>';
                zoomOutBtn.title = 'Zoom out';
                zoomOutBtn.addEventListener('click', () => {
                    threeDCamera.position.multiplyScalar(1.1);
                });
                
                // Reset view button
                const resetBtn = document.createElement('div');
                resetBtn.className = 'three-d-control-btn';
                resetBtn.innerHTML = '<i class="fas fa-home"></i>';
                resetBtn.title = 'Resetare vizualizare';
                resetBtn.addEventListener('click', () => {
                    threeDCamera.position.set(10, 8, 12);
                    threeDScene.rotation.y = 0;
                });
                
                // Add buttons to controls div
                controlsDiv.appendChild(rotateLeftBtn);
                controlsDiv.appendChild(rotateRightBtn);
                controlsDiv.appendChild(zoomInBtn);
                controlsDiv.appendChild(zoomOutBtn);
                controlsDiv.appendChild(resetBtn);
                
                // Add to container
                view3DContainer.appendChild(controlsDiv);
            }
            
            // Animate 3D scene
            function animate3D() {
                requestAnimationFrame(animate3D);
                
                // Only render if 3D view is active
                if (is3DViewActive && threeDRenderer && threeDScene && threeDCamera) {
                    threeDRenderer.render(threeDScene, threeDCamera);
                }
            }
            
            // Save design
            function saveDesign() {
                if (designArea.classList.contains('empty')) {
                    alert('Te rog încarcă un plan al camerei înainte de a salva designul.');
                    return;
                }
                
                const placedFurniture = document.querySelectorAll('.furniture-placed');
                
                if (placedFurniture.length === 0) {
                    alert('Adaugă cel puțin un mobilier în cameră înainte de a salva designul.');
                    return;
                }
                
                // Check if we have enough plants compared to furniture
                if (essentialCount > 0 && plantCount < essentialCount) {
                    if (!confirm(`Ai ${plantCount} plante și ${essentialCount} mobile esențiale. Recomandăm mai multe plante pentru un spațiu minimalist. Dorești să continui?`)) {
                        return;
                    }
                }
                
                // In a real app, this would save to a server or generate an image
                const styleName = styleNames[selectedStyle];
                const has3D = threeDScene !== null ? 'și vizualizare 3D' : '';
                
                alert(`Designul tău minimalist în stil ${styleName} cu ${plantCount} plante a fost salvat! ${has3D}`);
                
                // Log design details to console (for demo purposes)
                console.log('Design minimalist salvat:');
                console.log('- Stil:', styleName);
                console.log('- Plante:', plantCount);
                console.log('- Mobile esențiale:', essentialCount);
                console.log('- Raport plante/mobile:', plantCount + ':' + essentialCount);
                console.log('- Total obiecte:', placedFurniture.length);
                console.log('- Obiecte 3D generate:', threeDModelsCount);
            }
            
            // Initialize the app
            init();
        });
    </script>
</body>
</html>